# PROJECT: Mountain View Community Hospital

## Project Overview
This project is a database management system for Mountain View Community Hospital. It includes tables for patients, doctors, appointments, users, medical records, and notifications. The system also includes triggers and procedures to manage and automate various tasks.

## Database Schema
The database schema includes the following tables:
- `patients`
- `doctors`
- `appointments`
- `users`
- `medical_records`
- `notifications`

### Patients Table
```sql
CREATE TABLE patients (
    patient_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    first_name VARCHAR2(50) NOT NULL CHECK (REGEXP_LIKE(first_name, '^[A-Za-z]+$', 'i')), 
    last_name VARCHAR2(50) NOT NULL CHECK (REGEXP_LIKE(last_name, '^[A-Za-z]+$', 'i')),  
    dob DATE NOT NULL,
    gender CHAR(1) CHECK (gender IN ('M', 'F', 'O')),
    contact_info VARCHAR2(11) NOT NULL CHECK (REGEXP_LIKE(contact_info, '^[0-9]{11}$')), 
    email VARCHAR2(100) UNIQUE NOT NULL CHECK (REGEXP_LIKE(email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.com$', 'i')), 
    insurance_policy VARCHAR2(50) NULL
);
```

### Doctors Table
```sql
CREATE TABLE doctors (
    doctor_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    first_name VARCHAR2(50) NOT NULL CHECK (REGEXP_LIKE(first_name, '^[A-Za-z]+$', 'i')), 
    last_name VARCHAR2(50) NOT NULL CHECK (REGEXP_LIKE(last_name, '^[A-Za-z]+$', 'i')),  
    specialization VARCHAR2(100) NOT NULL,
    contact_info VARCHAR2(11) NOT NULL CHECK (REGEXP_LIKE(contact_info, '^[0-9]{11}$')), 
    email VARCHAR2(100) UNIQUE NOT NULL CHECK (REGEXP_LIKE(email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.com$', 'i')) 
);
```

### Appointments Table
```sql
CREATE TABLE appointments (
    appointment_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    patient_id NUMBER NOT NULL REFERENCES patients(patient_id) ON DELETE CASCADE,
    doctor_id NUMBER NOT NULL REFERENCES doctors(doctor_id) ON DELETE SET NULL,
    appointment_date DATE NOT NULL,
    reason VARCHAR2(255),
    status VARCHAR2(20) CHECK (status IN ('Scheduled', 'Completed', 'Canceled')),
    CONSTRAINT appointment_unique UNIQUE (patient_id, doctor_id, appointment_date)
);
```

### Users Table
```sql
CREATE TABLE users (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) UNIQUE NOT NULL,
    password_hash VARCHAR2(255) NOT NULL,
    role VARCHAR2(20) CHECK (role IN ('Physician', 'Admin', 'Patient')),
    linked_patient_id NUMBER NULL REFERENCES patients(patient_id) ON DELETE CASCADE
);
```

### Medical Records Table
```sql
CREATE TABLE medical_records (
    record_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    patient_id NUMBER NOT NULL REFERENCES patients(patient_id) ON DELETE CASCADE,
    doctor_id NUMBER NOT NULL REFERENCES doctors(doctor_id),
    diagnosis VARCHAR2(255) NOT NULL,
    treatment VARCHAR2(255) NOT NULL,
    record_date DATE DEFAULT SYSDATE
);
```

### Notifications Table
```sql
CREATE TABLE notifications (
    notification_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    message VARCHAR2(255) NOT NULL,
    notification_date DATE DEFAULT SYSDATE
);
```

### Triggers
```sql
CREATE OR REPLACE TRIGGER trg_patients_contact_email
BEFORE INSERT OR UPDATE ON patients
FOR EACH ROW
BEGIN
    IF NOT REGEXP_LIKE(:NEW.contact_info, '^[0-9]{11}$') THEN
        RAISE_APPLICATION_ERROR(-20001, 'Contact number must be exactly 11 digits and contain no alphabets.');
    END IF;

    IF NOT REGEXP_LIKE(:NEW.email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.com$', 'i') THEN
        RAISE_APPLICATION_ERROR(-20002, 'Email must contain a valid format with @ and .com');
    END IF;
END;
```